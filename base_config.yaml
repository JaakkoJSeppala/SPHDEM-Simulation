# ===========================================
# Base configuration for SPH–DEM sloshing damper simulation
# ===========================================
simulation:
  name: "baseline_case"
  description: "SPH–DEM coupled model of partially filled cylindrical tank"
  version: 1.0
  solver: "DualSPHysics+Chrono"
  dimension: 3
  time:
    t_end: 5.0                # [s]
    output_interval: 0.001    # [s] how often velocity etc. saved
    CFL: 0.7
    time_step_mode: "auto"    # CFL-based adaptive

physics:
  gravity: [0.0, -9.81, 0.0]  # [m/s^2] vertical downward
  temperature: 298.15         # [K], optional

# ===========================================
# Geometry (tank)
# ===========================================
tank:
  type: "cylinder"
  length_m: 0.10              # [m]
  diameter_m: 0.044           # [m]
  wall_thickness_m: 0.002
  fill_height_m: 0.0197       # [m] (≈ 30 ml water)
  material:
    name: "acrylic"
    density: 1180             # [kg/m³]
    poisson: 0.35
    youngs_modulus: 3.2e9     # [Pa]

# ===========================================
# Fluid (SPH phase)
# ===========================================
fluid:
  name: "water"
  rho0: 1000.0                # [kg/m³]
  mu: 8.9e-4                  # [Pa·s]
  gamma: 7.0
  c0: 10.0                    # [×Umax] target Mach < 0.1
  Umax_est: 0.5               # [m/s] approximate max velocity
  equation_of_state: "Tait"
  h_smoothing: 7.5e-4         # [m]
  particle_spacing: 6.0e-4    # [m] ≈ 0.8h
  artificial_viscosity_alpha: 0.03
  artificial_viscosity_beta: 0.0
  density_diffusion: true
  turbulence_model:
    type: "Smagorinsky"
    Cs: 0.1

# ===========================================
# Solids (DEM phase)
# ===========================================
dem:
  enabled: true
  n_particles: 60
  particle_shape: "tetrapod"
  particle_size_m: 0.008      # [m] bounding box
  density: 1200.0             # [kg/m³]
  restitution_coeff: 0.4
  friction_coeff_static: 0.5
  friction_coeff_dynamic: 0.45
  contact_model: "Hertz-Mindlin"
  youngs_modulus: 1.0e9       # [Pa]
  poisson: 0.3
  damping_ratio: 0.2
  mesh_file: "tetrapod.stl"   # optional, if shape != sphere

# ===========================================
# Coupling between SPH and DEM
# ===========================================
coupling:
  type: "two-way"
  interface:
    method: "virtual_shell"   # each DEM particle has SPH surface layer
    shell_thickness: 1.0e-3   # [m]
  drag_model: "custom"        # use SPH pressure + viscous exchange
  enable_buoyancy: true
  enable_pressure_forces: true
  feedback_to_fluid: true

# ===========================================
# Integration and numerics
# ===========================================
integration:
  scheme: "leapfrog"
  order: 2
  adaptive_time_step: true
  max_time_step: 1e-4         # [s]
  min_time_step: 1e-6         # [s]

boundary_conditions:
  type: "dynamic_wall_particles"
  wall_penalty_stiffness: 1.0e6
  no_slip: true
  symmetry_planes: []

# ===========================================
# Output and diagnostics
# ===========================================
output:
  save_velocity: true
  save_pressure: true
  save_positions: false
  save_energy: true
  file_format: "csv"
  directory: "runs/"
  report_metrics:
    - "sloshing_frequency"
    - "log_decrement"
    - "energy_dissipation"

postprocessing:
  enable: true
  scripts:
    - "analysis/postprocess_velocity.py"
    - "analysis/postprocess_energy.py"

# ===========================================
# End of file
# ===========================================
